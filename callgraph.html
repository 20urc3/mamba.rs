<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Mamba â€” Callâ€‘Graph Construction</title>
<link rel="stylesheet" href="style.css" />
<style>
/* Reâ€‘use the same token palette for consistency */
:root{--accent:#0a84ff;--text:#1c1c1e;--bg:#ffffff;--card:#f7f7f9}
@media(prefers-color-scheme:dark){:root{--text:#e6e6e6;--bg:#2a2a2e;--card:#313135}}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;margin:0;padding:2rem}
h1{font-size:2rem;margin-bottom:1rem}
h2{font-size:1.5rem;margin-top:2rem;margin-bottom:.75rem}
pre{background:var(--card);padding:1rem;border-radius:16px;overflow:auto;font-size:.9rem}
code{font-family:"SFMono-Regular",Consolas,Menlo,monospace}
.box{background:var(--card);padding:1.5rem;border-radius:24px;margin-top:2rem}
a{color:var(--accent);text-decoration:none}
a:hover{text-decoration:underline}
</style>
</head>
<body>
<h1>Callâ€‘Graph Construction</h1>
<div class="box">
<p><strong>Definition:</strong> Every variableâ€™s pointsâ€‘to set is its own explicit seed (addresses taken at that variable) plus everything that flows in along assignments, loads, stores, etc.â€”repeat that rule until no set grows; the final sets drive the callâ€‘graph edges.</p>
</div>
<h2>Pseudoâ€‘code</h2>
<pre><code>repeat until we add no new edges

  1. Walk every basic block
       â€¢ For each instruction:
           â€“ if it is a direct call    â†’ add caller â†’ callee edge
           â€“ if it is an indirect call â†’ remember the call-site + operand
           â€“ if it copies a pointer    â†’ remember â€œsource pointer can flow to destinationâ€
             (includes store, load, bitcast, getelementptr, phi, return, paramâ€‘passing)

  2. Pointerâ€‘tracking phase
       â€¢ Seed: for every vâ€‘table slot and every â€œaddressâ€‘takenâ€ function,
         put that function into the pointsâ€‘to set of the variable that holds the pointer.
       â€¢ Workâ€‘list flood:
           while some variableâ€™s pointsâ€‘to set just grew
               push all destinations it flows to (from the copy list) onto the workâ€‘list
               copy the new functions into their pointsâ€‘to sets

  3. Resolve each remembered indirect call
       â€¢ Look up the pointsâ€‘to set of its callee operand
       â€¢ Add caller â†’ each target edge
       â€¢ If any edge is brandâ€‘new, the outer loop will run again
</code></pre>
<h2>Mathematical Formulation</h2>
<p><em>Notation:</em></p>
<ul>
<li><strong>F</strong> â€“ all LLVM functions</li>
<li><strong>C</strong> â€“ the set of every callâ€‘site instruction</li>
<li><code>caller(c)</code> â€“ function that contains callâ€‘site <em>c</em></li>
<li><code>callee(c)</code> â€“ direct callee when <em>c</em> is a direct call</li>
<li><code>op(c)</code> â€“ SSA value holding the callee operand (pointer)</li>
</ul>
<p>The least fixedâ€‘point pointsâ€‘to map <code>P*: V â†’ ğ’«(F)</code> is:</p>
<pre><code>P* = lfp_P ( v â†¦ Seeds(v) âˆª â‹ƒ_{(u,v)âˆˆE} P(u) )</code></pre>
<p>Seeds = functions whose addresses flow into <em>v</em>; <em>E</em> = all pointerâ€‘copy edges (load, store, Ï†, â€¦).</p>
<p>Then the complete callâ€‘graph is:</p>
<pre><code>CG = { ( caller(c) , t ) | c âˆˆ C ,
        t âˆˆ    { callee(c) }           if c direct
            âˆª P*( op(c) )              if c indirect }
</code></pre>
<p>Every pair (<em>caller</em>, <em>t</em>) is an edge; direct calls yield one target, indirect calls yield every function in the operandâ€™s pointsâ€‘to set.</p>
<footer style="margin-top:3rem;text-align:center;font-size:.85rem">
  <a href="index.html">â† Back to main page</a>
</footer>
</body>
</html>
